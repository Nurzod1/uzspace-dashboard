<script setup lang="ts">
import { ref } from 'vue'
import TableLog from '@/components/StatusUpdates/STableLog.vue'
import 'element-plus/es/components/pagination/style/css'
import { ElPagination } from 'element-plus'
import { onMounted } from 'vue'

const currentPage = ref(1)
const pageSize = ref(10)
const totalItems = ref(0)

const handlePageChange = (page: number) => {
  currentPage.value = page
}

const handleSizeChange = (size: number) => {
  pageSize.value = size
}

let tableLogRef = ref(null)

onMounted(() => {
  if (tableLogRef.value) {
    totalItems.value = tableLogRef.value.totalItems
  }
})
</script>

<template>
  <div class="logs-wrapper">
    <div class="logs-header">
      <p class="logs-header__title">Status Updates</p>
      <div class="logs-header__btns">
        <button class="logs-header__btn">
          <div class="logs-header__btn--icon">
            <svg
              width="20"
              height="20"
              viewBox="0 0 20 20"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M14.6875 6.5625C14.6875 6.5625 14.0523 6.5625 13.5475 6.87743C13.5475 6.87743 13.3898 6.54615 13.1093 6.2657C13.1093 6.2657 12.4686 5.625 11.5625 5.625C11.5625 5.625 11.0516 5.625 10.625 5.82873V2.8125C10.625 2.8125 10.625 1.90641 9.98433 1.2657C9.98433 1.2657 9.34363 0.625 8.43753 0.625C8.43753 0.625 7.53144 0.625 6.89074 1.2657C6.89074 1.2657 6.25003 1.90641 6.25003 2.8125V9.95291L5.70559 9.00821C5.70559 9.00821 5.25271 8.22246 4.37687 7.98709C4.37687 7.98709 3.50102 7.75172 2.71527 8.2046C2.71527 8.2046 1.92953 8.65748 1.69415 9.53332C1.69415 9.53332 1.46225 10.3963 1.89847 11.1718C1.89847 11.1718 2.91811 13.3189 3.68499 14.5997C3.68499 14.5997 4.57532 16.0868 5.44424 16.958C5.44424 16.958 6.38396 17.9001 7.49648 18.331C7.49648 18.331 8.5784 18.75 10 18.75C10 18.75 11.3676 18.75 12.631 18.2267C12.631 18.2267 13.8944 17.7033 14.8614 16.7364C14.8614 16.7364 15.8284 15.7694 16.3517 14.5059C16.3517 14.5059 16.875 13.2425 16.875 11.875V8.75C16.875 8.75 16.875 7.84391 16.2343 7.2032C16.2343 7.2032 15.5936 6.5625 14.6875 6.5625ZM12.5 7.8125V8.75C12.5 9.09518 12.7799 9.375 13.125 9.375C13.4702 9.375 13.75 9.09518 13.75 8.75C13.75 8.75 13.75 8.36167 14.0246 8.08709C14.0246 8.08709 14.2992 7.8125 14.6875 7.8125C14.6875 7.8125 15.0759 7.8125 15.3504 8.08709C15.3504 8.08709 15.625 8.36167 15.625 8.75V11.875C15.625 11.875 15.625 12.9939 15.1969 14.0276C15.1969 14.0276 14.7687 15.0613 13.9775 15.8525C13.9775 15.8525 13.1863 16.6436 12.1526 17.0718C12.1526 17.0718 11.1189 17.5 10 17.5C10 17.5 8.812 17.5 7.94792 17.1654C7.94792 17.1654 7.08213 16.83 6.32926 16.0752C6.32926 16.0752 5.56886 15.3129 4.75746 13.9576C4.75746 13.9576 4.01781 12.7222 3.01781 10.6149C3.01068 10.5998 3.00296 10.5851 2.99465 10.5707C2.99465 10.5707 2.80033 10.2336 2.90132 9.85773C2.90132 9.85773 3.00232 9.48192 3.33948 9.28759C3.33948 9.28759 3.67664 9.09326 4.05245 9.19426C4.05245 9.19426 4.42827 9.29525 4.6226 9.63241L6.33352 12.6011C6.41629 12.7448 6.55272 12.8496 6.7128 12.8926C6.87288 12.9357 7.0435 12.9133 7.18711 12.8306C7.38072 12.719 7.50003 12.5125 7.50003 12.2891V2.8125C7.50003 2.8125 7.50003 2.42417 7.77462 2.14959C7.77462 2.14959 8.04921 1.875 8.43753 1.875C8.43753 1.875 8.82586 1.875 9.10044 2.14959C9.10044 2.14959 9.37503 2.42417 9.37503 2.8125V7.8125C9.37503 8.15768 9.65485 8.4375 10 8.4375C10.3452 8.4375 10.625 8.15768 10.625 7.8125C10.625 7.8125 10.625 7.42417 10.8996 7.14959C10.8996 7.14959 11.1742 6.875 11.5625 6.875C11.5625 6.875 11.9509 6.875 12.2254 7.14959C12.2254 7.14959 12.5 7.42417 12.5 7.8125Z"
                fill="#1C1C1C"
              />
            </svg>
          </div>
          <span class="logs-header__btn--text">Trigger Update</span>
        </button>
        <button class="logs-header__btn">
          <div class="logs-header__btn--icon">
            <svg
              width="20"
              height="20"
              viewBox="0 0 20 20"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M10 1.875C10 1.875 11.6526 1.875 13.1628 2.51376C13.1628 2.51376 14.621 3.13053 15.7452 4.25476C15.7452 4.25476 16.8695 5.37899 17.4862 6.83719C17.4862 6.83719 18.125 8.34739 18.125 10C18.125 10 18.125 11.6526 17.4862 13.1628C17.4862 13.1628 16.8695 14.621 15.7452 15.7452C15.7452 15.7452 14.621 16.8695 13.1628 17.4862C13.1628 17.4862 11.6526 18.125 10 18.125C10 18.125 8.34739 18.125 6.83719 17.4862C6.83719 17.4862 5.37899 16.8695 4.25476 15.7452C4.25476 15.7452 3.13053 14.621 2.51376 13.1628C2.51376 13.1628 1.875 11.6526 1.875 10C1.875 10 1.875 8.34739 2.51376 6.83719C2.51376 6.83719 3.13053 5.37899 4.25476 4.25476C4.25476 4.25476 5.37899 3.13053 6.83719 2.51376C6.83719 2.51376 8.34739 1.875 10 1.875ZM10 3.125C10 3.125 8.60087 3.125 7.32413 3.66501C7.32413 3.66501 6.09047 4.18681 5.13864 5.13864C5.13864 5.13864 4.18681 6.09047 3.66502 7.32413C3.66502 7.32413 3.125 8.60087 3.125 10C3.125 10 3.125 11.3991 3.66502 12.6759C3.66502 12.6759 4.18681 13.9095 5.13864 14.8614C5.13864 14.8614 6.09047 15.8132 7.32413 16.335C7.32413 16.335 8.60087 16.875 10 16.875C10 16.875 11.3991 16.875 12.6759 16.335C12.6759 16.335 13.9095 15.8132 14.8614 14.8614C14.8614 14.8614 15.8132 13.9095 16.335 12.6759C16.335 12.6759 16.875 11.3991 16.875 10C16.875 10 16.875 8.60087 16.335 7.32413C16.335 7.32413 15.8132 6.09047 14.8614 5.13864C14.8614 5.13864 13.9095 4.18681 12.6759 3.66501C12.6759 3.66501 11.3991 3.125 10 3.125Z"
                fill="#1C1C1C"
              />
              <path
                d="M10 10.625H14.375C14.7202 10.625 15 10.3452 15 10C15 9.65482 14.7202 9.375 14.375 9.375H10.625V5.625C10.625 5.27982 10.3452 5 10 5C9.65482 5 9.375 5.27982 9.375 5.625V10C9.375 10.3452 9.65482 10.625 10 10.625Z"
                fill="#1C1C1C"
              />
            </svg>
          </div>
          <span class="logs-header__btn--text">EnableScheduler</span>
        </button>
        <button class="logs-header__btn">
          <div class="logs-header__btn--icon">
            <svg
              width="20"
              height="20"
              viewBox="0 0 20 20"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M2.5 3.75C2.5 3.75 2.5 3.23223 2.86612 2.86612C2.86612 2.86612 3.23223 2.5 3.75 2.5H16.25C16.25 2.5 16.7678 2.5 17.1339 2.86612C17.1339 2.86612 17.5 3.23223 17.5 3.75V16.25C17.5 16.25 17.5 16.7678 17.1339 17.1339C17.1339 17.1339 16.7678 17.5 16.25 17.5H3.75C3.75 17.5 3.23223 17.5 2.86612 17.1339C2.86612 17.1339 2.5 16.7678 2.5 16.25V3.75ZM3.75 3.75V16.25H16.25V3.75H3.75Z"
                fill="#1C1C1C"
              />
              <path
                d="M13.125 1.875V4.375C13.125 4.72018 13.4048 5 13.75 5C14.0952 5 14.375 4.72018 14.375 4.375V1.875C14.375 1.52982 14.0952 1.25 13.75 1.25C13.4048 1.25 13.125 1.52982 13.125 1.875Z"
                fill="#1C1C1C"
              />
              <path
                d="M5.625 1.875V4.375C5.625 4.72018 5.90482 5 6.25 5C6.59518 5 6.875 4.72018 6.875 4.375V1.875C6.875 1.52982 6.59518 1.25 6.25 1.25C5.90482 1.25 5.625 1.52982 5.625 1.875Z"
                fill="#1C1C1C"
              />
              <path
                d="M3.125 7.5H16.875C17.2202 7.5 17.5 7.22018 17.5 6.875C17.5 6.52982 17.2202 6.25 16.875 6.25H3.125C2.77982 6.25 2.5 6.52982 2.5 6.875C2.5 7.22018 2.77982 7.5 3.125 7.5Z"
                fill="#1C1C1C"
              />
              <path
                d="M12.3167 10.4422C12.4339 10.325 12.5 10.1658 12.5 10C12.5 9.83424 12.4342 9.67527 12.3169 9.55806L12.3115 9.55273C12.1948 9.439 12.038 9.375 11.875 9.375C11.8563 9.375 11.8375 9.37584 11.8188 9.37753C11.6731 9.39068 11.5365 9.45457 11.4331 9.55806L7.68329 13.3078C7.56608 13.425 7.5 13.5842 7.5 13.75C7.5 13.76 7.50024 13.77 7.50072 13.78C7.50819 13.9352 7.57319 14.0821 7.68306 14.1919C7.80027 14.3092 7.95924 14.375 8.125 14.375C8.29076 14.375 8.44973 14.3092 8.56694 14.1919L12.3167 10.4422Z"
                fill="#1C1C1C"
              />
              <path
                d="M8.56694 9.55806C8.44973 9.44085 8.29076 9.375 8.125 9.375C7.95924 9.375 7.80027 9.44085 7.68306 9.55806C7.56585 9.67527 7.5 9.83424 7.5 10C7.5 10.1658 7.56585 10.3247 7.68306 10.4419L11.4327 14.1916C11.5499 14.3088 11.7092 14.375 11.875 14.375C12.0408 14.375 12.1997 14.3092 12.3169 14.1919C12.4342 14.0747 12.5 13.9158 12.5 13.75C12.5 13.5842 12.4342 13.4253 12.3169 13.3081L8.56694 9.55806Z"
                fill="#1C1C1C"
              />
            </svg>
          </div>
          <span class="logs-header__btn--text">Disable Scheduler</span>
        </button>
      </div>
    </div>
    <div class="logs-wrapper__content">
      <TableLog ref="tableLogRef" :page="currentPage" :size="pageSize" />
    </div>
    <div class="logs-wrapper__pagination">
      <el-pagination
        layout="prev, pager, next"
        :total="totalItems"
        :current-page="currentPage"
        :page-size="pageSize"
        @current-change="handlePageChange"
        @size-change="handleSizeChange"
      />
    </div>
  </div>
</template>

<style lang="scss">
.logs {
  &-wrapper {
    overflow: auto;
    padding: 30px;
    max-width: 1200px;
    height: 100%;
    display: flex;
    flex-direction: column;

    &__charts {
      display: flex;
      gap: 30px;
      margin-bottom: 30px;
    }

    &__pagination {
      margin-top: 12px;
      display: flex;
      justify-content: end;
      flex: 1;
      align-items: end;
    }
  }

  &-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 24px;

    &__title {
      font-size: 24px;
      font-weight: 600;
    }

    &__btns {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    &__btn {
      display: flex;
      align-items: center;
      border: 1px solid #f5f5f5;
      border-radius: 8px;
      padding: 7px 15px;
      transition: 0.3s;

      &:hover {
        border-color: #e1e1e1;
      }

      &--icon {
        max-width: 20px;
        max-height: 20px;
        margin-right: 4px;
      }

      &--text {
        font-size: 14px;
      }
    }
  }
}

.el-pager li:hover {
  background-color: #f3f3f3;
  border-radius: 8px;
}
</style>
